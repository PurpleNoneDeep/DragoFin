{% extends 'main/layout.html' %}
{% load static %}
{% block title %}Новая транзакция{% endblock %}
{% block head %}<link rel="stylesheet" href="{% static 'main/css/auth.css' %}">
<style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f4f4f4;
        }
        .form-container {
            background: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 300px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            margin-bottom: 5px;
            display: block;
        }
        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
        }
        button:hover {
            background-color: #218838;
        }
    </style>
    <script>
        const categories = {
            'income': ['Зарплата', 'Инвестиции', 'Прочее'],
            'expense': ['Продукты', 'Транспорт', 'Развлечения']
        };

        function updateCategories() {
            const type = document.getElementById('transaction-type').value;
            const categorySelect = document.getElementById('category');

            // Очистка предыдущих опций
            categorySelect.innerHTML = '';

            // Добавление стандартных категорий
            categories[type].forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                categorySelect.appendChild(option);
            });

            // Добавление опции для ввода собственной категории
            const customOption = document.createElement('option');
            customOption.value = 'custom';
            customOption.textContent = 'Другая категория';
            categorySelect.appendChild(customOption);
        }

        function handleCustomCategory() {
            const categorySelect = document.getElementById('category');
            const customCategoryInput = document.getElementById('custom-category');
            if (categorySelect.value === 'custom') {
                customCategoryInput.style.display = 'block';
            } else {
                customCategoryInput.style.display = 'none';
            }
        }
    </script>{% endblock %}
{% block content %}
<header>
<div>
    <button onclick="window.location.href='{% url 'home' %}'">Вернуться на главную</button>
</div>
</header>
<main>

<div class="form-container">
    <h2>Добавить транзакцию</h2>
    <form method="POST" action="{% url 'add_transaction' %}">
        {% csrf_token %}
        <div class="form-group">
            <label for="date">Дата транзакции:</label>
            <input type="date" id="date" name="date" required>
        </div>

        <div class="form-group">
            <label for="transaction-type">Тип транзакции:</label>
            <select id="transaction-type" name="type" onchange="updateCategories()" required>
                <option value="income">Доход</option>
                <option value="expense">Расход</option>
            </select>
        </div>

        <div class="form-group">
            <label for="category">Категория:</label>
            <select id="category" name="category" onchange="handleCustomCategory()" required>
                <option value="">Выберите категорию</option>
            </select>
            <input type="text" id="custom-category" name="custom_category" placeholder="Введите свою категорию" style="display:none;">
        </div>

        <div class="form-group">
            <label for="amount">Сумма:</label>
            <input type="number" id="amount" name="amount" step="0.01" min="0" required>
        </div>

        <div class="form-group">
            <label for="description">Описание:</label>
            <textarea id="description" name="description" maxlength="300"></textarea>
        </div>

        <button type="submit">Добавить транзакцию</button>
    </form>
</div>

<script>
    // Инициализация категорий при загрузке страницы
    document.addEventListener('DOMContentLoaded', () => {
        updateCategories();
    });
</script>
</main>
{% endblock %}